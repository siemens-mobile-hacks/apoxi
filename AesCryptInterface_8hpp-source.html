<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>APOXI: AddOns/Aes/AesCryptInterface.hpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.6-NO -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<h1>AddOns/Aes/AesCryptInterface.hpp</h1><a href="AesCryptInterface_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#if !defined(AesCryptInterface_hpp)</span>
<a name="l00002"></a><a class="code" href="AesCryptInterface_8hpp.html#40407d862092979f556e60cfcf961712">00002</a> <span class="preprocessor"></span><span class="preprocessor">#define AesCryptInterface_hpp</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &lt;<a class="code" href="Kernel_2Types_8hpp.html">Kernel/Types.hpp</a>&gt;</span>
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 <span class="comment">// AES currently is provided from Prof. Gladman's C implementation</span>
<a name="l00007"></a>00007 <span class="comment">// It currently supports the following features only (to reduce code size)</span>
<a name="l00008"></a>00008 <span class="comment">// Features chosen for DRM</span>
<a name="l00009"></a>00009 <span class="comment">//</span>
<a name="l00010"></a>00010 <span class="comment">//  - Decryption only</span>
<a name="l00011"></a>00011 <span class="comment">//  - 128 bit keysize</span>
<a name="l00012"></a>00012 <span class="comment">//  - CBC Mode</span>
<a name="l00013"></a>00013 <span class="comment">//  - 128 bit blocksize</span>
<a name="l00014"></a>00014 <span class="comment">//</span>
<a name="l00015"></a>00015 
<a name="l00018"></a><a class="code" href="AesCryptInterface_8hpp.html#123502b1098421d103e7f05ec023e325">00018</a> <span class="keyword">enum</span> <a class="code" href="AesCryptInterface_8hpp.html#123502b1098421d103e7f05ec023e325">AesError</a> {
<a name="l00019"></a>00019     <a class="code" href="AesCryptInterface_8hpp.html#123502b1098421d103e7f05ec023e325df3550348d80c3bd59aa0a80a093b94f">AesErrorNone</a> = 0,           <span class="comment">// No Error</span>
<a name="l00020"></a>00020     <a class="code" href="AesCryptInterface_8hpp.html#123502b1098421d103e7f05ec023e32579090968b053224f608ecb0289d77a5a">AesGeneralError</a>,            <span class="comment">// General failure - no specific info available</span>
<a name="l00021"></a>00021     <a class="code" href="AesCryptInterface_8hpp.html#123502b1098421d103e7f05ec023e3253e83623d9ad1443160722498e6c52be5">AesNoKey</a>,                   <span class="comment">// Key not set</span>
<a name="l00022"></a>00022     <a class="code" href="AesCryptInterface_8hpp.html#123502b1098421d103e7f05ec023e3256d9cace49a907e11fd22b600ccd0b8d9">AesInvalidBlockWindow</a>       <span class="comment">// Invalid start_block end_block combination</span>
<a name="l00023"></a>00023 };
<a name="l00024"></a>00024 
<a name="l00077"></a>00077 
<a name="l00078"></a><a class="code" href="classAesCrypt.html">00078</a> <span class="keyword">class </span><a class="code" href="classAesCrypt.html">AesCrypt</a> {
<a name="l00079"></a>00079     <span class="keyword">public</span>:
<a name="l00081"></a><a class="code" href="classAesCrypt.html#0dc07faf27b2f9634fd4b9be67fff6ab">00081</a>         <span class="keyword">enum</span> <a class="code" href="classAesCrypt.html#0dc07faf27b2f9634fd4b9be67fff6ab">PaddingMethod</a> {
<a name="l00082"></a>00082             <a class="code" href="classAesCrypt.html#0dc07faf27b2f9634fd4b9be67fff6ab3da48fe2a8586eb289922a31cacc1137">PaddingMethod2630</a>,          <span class="comment">// RFC 2630</span>
<a name="l00083"></a>00083             <a class="code" href="classAesCrypt.html#0dc07faf27b2f9634fd4b9be67fff6ab3fdde83743b6a00e7130ed69878eee48">PaddingMethodNone</a>           <span class="comment">// None</span>
<a name="l00084"></a>00084         };
<a name="l00085"></a>00085 
<a name="l00086"></a>00086         <span class="comment">// Constructor</span>
<a name="l00087"></a><a class="code" href="classAesCrypt.html#ae186253625c9dd80e6786732596cea1">00087</a>         <a class="code" href="classAesCrypt.html#ae186253625c9dd80e6786732596cea1">AesCrypt</a>() : m_last_error(<a class="code" href="AesCryptInterface_8hpp.html#123502b1098421d103e7f05ec023e325df3550348d80c3bd59aa0a80a093b94f">AesErrorNone</a>) {}
<a name="l00088"></a>00088         <span class="comment">// Destructor</span>
<a name="l00089"></a><a class="code" href="classAesCrypt.html#d86cfd9d9314f10e4f9efbd078f76f9a">00089</a>         <a class="code" href="classAesCrypt.html#d86cfd9d9314f10e4f9efbd078f76f9a">~AesCrypt</a>() {}
<a name="l00090"></a>00090 
<a name="l00094"></a>00094         <span class="keywordtype">void</span> <a class="code" href="classAesCrypt.html#feb609f7e876e24dc483207d16f5e965">SetKey</a>(<span class="keyword">const</span> <a class="code" href="NucInc_8hpp.html#d8ce12d83f204245685f98caf9d03944">UINT8</a>* key);
<a name="l00095"></a>00095 
<a name="l00099"></a><a class="code" href="classAesCrypt.html#287374e59b149b5cde0c84cfe8e8fbe0">00099</a>         <a class="code" href="AesCryptInterface_8hpp.html#123502b1098421d103e7f05ec023e325">AesError</a> <a class="code" href="classAesCrypt.html#287374e59b149b5cde0c84cfe8e8fbe0">GetLastAesError</a>()<span class="keyword"> const</span>
<a name="l00100"></a>00100 <span class="keyword">            </span>{ <span class="keywordflow">return</span> m_last_error; }
<a name="l00101"></a>00101 
<a name="l00116"></a>00116         <a class="code" href="NucInc_8hpp.html#feeffe52c8fd59db7c61cf8b02042dbf">INT</a> <a class="code" href="classAesCrypt.html#f8f519f4b5e7eb440c510c2bd65be7c5">DecryptBuffer</a>(<span class="keyword">const</span> <a class="code" href="NucInc_8hpp.html#ec93e83855ac17c3c25c55c37ca186dd">BYTE</a>* in, <a class="code" href="NucInc_8hpp.html#ec93e83855ac17c3c25c55c37ca186dd">BYTE</a>* out,
<a name="l00117"></a>00117             <a class="code" href="NucInc_8hpp.html#45c20c14d3d8790a22153d08ab2eb2ff">UINT</a> buf_len, <a class="code" href="classAesCrypt.html#0dc07faf27b2f9634fd4b9be67fff6ab">PaddingMethod</a> pad_method,
<a name="l00118"></a>00118             <a class="code" href="NucInc_8hpp.html#45c20c14d3d8790a22153d08ab2eb2ff">UINT</a> start_block=0, <a class="code" href="NucInc_8hpp.html#45c20c14d3d8790a22153d08ab2eb2ff">UINT</a> end_block=0);
<a name="l00119"></a>00119 
<a name="l00120"></a>00120     <span class="keyword">private</span>:
<a name="l00121"></a>00121         <a class="code" href="NucInc_8hpp.html#d8ce12d83f204245685f98caf9d03944">UINT8</a>           m_key[16];              <span class="comment">// 128 bit Key</span>
<a name="l00122"></a>00122         <a class="code" href="AesCryptInterface_8hpp.html#123502b1098421d103e7f05ec023e325">AesError</a>        m_last_error;           <span class="comment">// Last occured error code</span>
<a name="l00123"></a>00123 
<a name="l00130"></a>00130         <span class="keywordtype">void</span> XorBlock(<a class="code" href="NucInc_8hpp.html#ec93e83855ac17c3c25c55c37ca186dd">BYTE</a>* <a class="code" href="BP30_2ScrollHorizontal__16Bpp_8cpp.html#a9ca881d1075af5ef855342263ea4daf">left</a>, <span class="keyword">const</span> <a class="code" href="NucInc_8hpp.html#ec93e83855ac17c3c25c55c37ca186dd">BYTE</a>* <a class="code" href="BP30_2ScrollHorizontal__16Bpp_8cpp.html#273ca6d018315dd605d2beb359fedcec">right</a>, <span class="keyword">const</span> <a class="code" href="NucInc_8hpp.html#b1922c2d8643eb7da964d427604e992e">UINT16</a> <a class="code" href="VCard_8cpp.html#ba0f7f4fd1ef21c096f3621c26bda128">len</a>);
<a name="l00131"></a>00131 };
<a name="l00132"></a>00132 
<a name="l00134"></a>00134 <span class="preprocessor">#endif // AesCryptInterface_hpp</span>
<a name="l00135"></a>00135 <span class="preprocessor"></span>
<a name="l00136"></a>00136 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Jan 24 14:44:53 2006 for APOXI by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.6-NO </small></address>
</body>
</html>
